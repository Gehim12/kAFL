Search.setIndex({"docnames": ["dev/documentation", "how_to/linux_tutorial", "how_to/sharedir_tutorial", "how_to/windows_tutorial", "index", "reference/deployment", "reference/fuzzer_configuration", "reference/hypercall_api", "reference/user_interface", "reference/workdir_layout", "tutorials/fuzzing_linux_kernel", "tutorials/installation", "tutorials/introduction"], "filenames": ["dev/documentation.md", "how_to/linux_tutorial.md", "how_to/sharedir_tutorial.md", "how_to/windows_tutorial.md", "index.md", "reference/deployment.md", "reference/fuzzer_configuration.md", "reference/hypercall_api.md", "reference/user_interface.md", "reference/workdir_layout.md", "tutorials/fuzzing_linux_kernel.md", "tutorials/installation.md", "tutorials/introduction.md"], "titles": ["Building the documentation", "Getting Started with Linux Fuzzing", "Using Nyx htools + sharedir for OS Fuzzing", "Getting Started with Windows Fuzzing", "\ud83d\udcd7 kAFL\u2019s Documentation", "Deployment", "Fuzzer Configuration", "kAFL/Nyx Hypercall API", "kAFL User Interface", "kAFL Workdir", "Fuzzing the Linux Kernel", "Installation", "Introduction"], "terms": {"The": [0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11], "project": [0, 4, 5, 6], "": [0, 2, 3, 5, 6, 8, 10, 11], "i": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], "host": [0, 1, 2, 3, 5, 7, 9, 10], "onlin": 0, "To": [0, 1, 2, 3, 6, 9, 11], "doc": 0, "local": [0, 1, 2, 5, 6, 11, 12], "cd": [0, 1, 2, 10, 11], "make": [0, 1, 2, 4, 5, 7, 10], "html": 0, "xdg": [0, 6], "open": 0, "index": 0, "base": [1, 5, 8], "legaci": [1, 3], "kafl": [1, 2, 3, 6, 10, 12], "guid": [1, 3, 4, 12], "run": [1, 2, 3, 4, 5, 9, 10, 11], "newer": [1, 7, 11], "distribut": [1, 5], "mai": [1, 2, 3, 7, 9, 10], "requir": [1, 2, 4, 5, 10], "minor": 1, "fix": [1, 2, 3, 5], "provid": [1, 2, 10], "sampl": [1, 2], "code": [1, 2, 4, 7, 9, 10], "For": [1, 2, 3, 4, 7, 10], "follow": [1, 3, 4, 11], "step": [1, 3, 4, 9, 11], "download": [1, 2, 3, 4, 5, 11], "ubuntu": [1, 2, 3, 11], "16": [1, 8, 10], "04": [1, 2, 3, 11], "iso": [1, 3], "last": [1, 8], "verifi": [1, 4], "work": [1, 2, 3, 5, 9, 10], "version": [1, 2, 5, 7], "wget": 1, "c": [1, 2, 3, 7, 10], "o": [1, 4, 8, 9, 10], "http": [1, 5, 10, 11], "releas": [1, 5, 7, 8], "com": [1, 4, 5, 10, 11], "7": [1, 8, 10], "server": [1, 3, 10], "amd64": 1, "creat": [1, 3, 7, 9, 11], "qemu": [1, 2, 3, 4, 5, 7, 8, 9, 10], "hard": [1, 3, 9], "drive": [1, 3], "img": [1, 3], "f": [1, 3, 8], "qcow2": [1, 2, 3], "20g": 1, "machin": [1, 3, 5, 10, 11, 12], "q35": [1, 3], "enabl": [1, 3, 7, 10], "kvm": [1, 3, 4, 5, 10], "m": [1, 3, 10], "1024": [1, 3, 6], "hda": [1, 3], "cdrom": [1, 3], "insid": [1, 2, 11], "guest": [1, 2, 4, 5, 7, 9, 10], "clone": [1, 4, 5, 10], "repositori": [1, 4, 5, 11], "agent": [1, 2, 3, 7, 10, 12], "git": [1, 5, 10, 11], "github": [1, 5, 10, 11], "intellab": [1, 4, 10, 11], "sh": [1, 2, 3, 9, 11], "target": [1, 2, 3, 4, 7, 9, 11, 12], "perform": [1, 2, 5, 7, 8, 9, 10], "ani": [1, 2, 4, 6, 7, 9, 10, 11], "other": [1, 2, 3, 4, 5, 7, 9, 10], "setup": [1, 2, 5, 8, 10, 11, 12], "up": [1, 8, 9], "updat": [1, 2, 5], "grub": [1, 2, 5], "spectre_v2": [1, 2], "off": [1, 2, 10], "mitig": [1, 2, 10], "nopti": [1, 2, 10], "oop": [1, 2, 10], "panic": [1, 2, 7, 8, 10], "nokaslr": [1, 2, 10], "consol": [1, 2, 3], "ttys0": [1, 2], "sudo": [1, 2, 3, 10, 11], "sysctl": 1, "kernel": [1, 2, 4, 5, 11, 12], "randomize_va_spac": 1, "0": [1, 3, 8, 10], "shutdown": [1, 3], "gener": [1, 3, 4, 7], "directli": [1, 2, 3, 5, 10], "desir": [1, 4, 5], "hierarchi": 1, "help": [1, 10], "result": [1, 2, 7, 9, 10, 12], "smaller": 1, "footprint": 1, "snippet": 1, "minim": [1, 2, 4, 7], "root": [1, 2, 10, 11, 12], "us": [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "debootstrap": 1, "hello": [1, 2, 10], "world": [1, 2, 10], "kafl_vuln_test": [1, 2], "test": [1, 2, 3, 7, 9, 11], "case": [1, 5, 6, 7, 10], "tend": [1, 9], "have": [1, 2, 3, 5, 7, 11, 12], "similar": 1, "tool": [1, 2, 5, 6, 9, 10, 11], "e": [1, 2, 7, 8, 9], "g": [1, 2, 7, 8, 9], "febootstrap": 1, "fedora": 1, "you": [1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12], "can": [1, 2, 3, 5, 6, 7, 8, 9, 10, 11], "also": [1, 2, 6, 7, 8, 9, 10], "busybox": 1, "further": [1, 2, 4], "reduc": 1, "memori": [1, 3, 10], "your": [1, 2, 3, 4, 5, 8, 11, 12], "har": [1, 2, 7, 9, 10], "rootf": 1, "realpath": 1, "ubuntu_16": 1, "mkdir": [1, 2, 3], "p": [1, 2, 8, 10], "arch": [1, 10], "variant": 1, "minbas": 1, "includ": [1, 2, 5], "vim": 1, "ssh": 1, "xenial": 1, "archiv": [1, 8], "deploi": [1, 4, 5], "loader": [1, 3], "we": [1, 2, 3, 5, 7, 10, 11, 12], "current": [1, 2, 3, 5, 7, 8, 9, 11], "here": [1, 2, 3, 9], "so": [1, 3, 6, 7], "don": 1, "t": [1, 3, 5, 10, 11], "worri": 1, "about": [1, 7], "cross": [1, 2, 10], "compil": [1, 2, 3, 10], "port": [1, 4], "compon": [1, 2, 5], "choic": 1, "lib": 1, "modul": [1, 2], "cp": [1, 2, 3, 10], "unam": 1, "r": [1, 8, 10], "boot": [1, 2, 10], "fuzzer": [1, 2, 3, 4, 5, 7, 9, 10, 11, 12], "depend": [1, 5, 10], "linux_x86_64": [1, 2], "bin": [1, 2, 3, 10], "pushd": 1, "test_cas": [1, 2], "simpl": [1, 2, 10], "linux_x86": [1, 2], "64": [1, 2, 7, 8], "ko": [1, 2], "popd": 1, "launch": [1, 3, 8, 10], "tee": [1, 2], "etc": [1, 2, 5, 6, 7, 10], "rc": 1, "modprob": [1, 2, 3], "loop": [1, 2, 7, 10], "vfat": 1, "insmod": 1, "set": [1, 2, 4, 5, 7, 9], "password": [1, 11], "easi": [1, 4, 5], "login": [1, 3], "debug": [1, 3, 6, 7, 9], "chroot": 1, "passwd": 1, "wrap": 1, "time": [1, 2, 7, 8, 9], "need": [1, 2, 3, 5, 7], "aggreg": [1, 9], "regular": [1, 2, 7, 8, 9], "file": [1, 2, 3, 5, 6, 7, 8, 9, 10, 11], "mkf": 1, "ext4": 1, "l": [1, 8, 10], "n": [1, 2, 8, 9, 11], "d": [1, 2, 10], "2g": 1, "convert": [1, 5], "raw": 1, "note": [1, 3, 6, 9], "thi": [1, 2, 3, 5, 7, 8, 9, 10, 11, 12], "wai": [1, 2, 3, 5], "doe": [1, 2, 3, 9, 10], "bootload": 1, "initrd": 1, "sinc": [1, 3, 5, 7, 8, 10], "ha": [1, 2, 5, 8, 10, 11], "been": [1, 8, 11, 12], "proce": 1, "creation": 1, "final": 1, "configur": [1, 2, 4, 7], "when": [1, 2, 5, 7, 9, 10], "must": [1, 2, 7, 11], "ident": 1, "one": [1, 3, 9], "restor": [1, 7, 10], "later": 1, "dure": [1, 9, 10], "adjust": [1, 8], "ram": [1, 8, 9], "size": [1, 7, 8], "type": [1, 5, 7, 8], "peripher": 1, "avail": [1, 5, 8, 10, 11], "even": [1, 2], "thing": [1, 10], "like": [1, 3, 4, 5, 7], "miss": 1, "commandlin": [1, 9], "incompat": 1, "against": 1, "report": [1, 7, 8, 10], "log": [1, 2, 3, 6, 7, 9, 10], "kafl_fuzz": [1, 2, 3, 6, 9, 10, 11], "py": [1, 2, 3, 8, 9, 10, 11], "v": [1, 3, 8], "an": [1, 2, 4, 5, 6, 7, 8, 9, 10], "overlai": [1, 3], "copi": [1, 3, 9], "multipl": [1, 4, 10], "instanc": [1, 2, 4, 9, 10], "parallel": [1, 4, 10], "b": [1, 3, 10], "overlay_0": [1, 3], "execut": [1, 2, 3, 4, 5, 7, 8, 9, 10, 11], "initi": [1, 2, 7, 9, 10], "If": [1, 2, 5, 11], "path": [1, 3, 5, 8, 9, 10, 11], "abov": [1, 10], "snip": 1, "correspond": [1, 2, 3, 7, 9], "direct": 1, "automat": [1, 2, 7], "5": [1, 3, 4, 5, 8], "x86_64": [1, 3, 10], "softmmu": [1, 3, 10], "system": [1, 2, 3, 4, 6, 10, 11], "nograph": 1, "net": [1, 3, 10], "none": [1, 3, 10], "serial": [1, 2, 9, 10], "mon": 1, "stdio": 1, "vmlinuz": 1, "512": [1, 2, 10], "append": [1, 10], "dev": [1, 2, 3, 5, 6, 9, 10], "sda": 1, "rw": [1, 10], "wa": [1, 2, 5], "info": [1, 2, 3, 7, 8, 9, 10], "seq": 1, "nproc": [1, 10], "do": [1, 3, 10], "overlay_": 1, "done": [1, 2, 3, 7, 8], "virtual": [1, 5, 7, 10], "address": [1, 2, 7], "rang": [1, 2, 7, 10], "trace": [1, 2, 6, 7, 9, 10, 11], "coverag": [1, 4, 8, 9, 10], "feedback": [1, 4, 7, 8, 9], "It": [1, 3, 4, 5, 7, 9, 10], "recommend": [1, 2, 9], "specif": [1, 7], "subsystem": 1, "want": [1, 3, 5, 11], "order": [1, 4], "nois": 1, "schedul": [1, 4, 8], "interrupt": 1, "obtain": [1, 7, 8], "driver": [1, 2], "kafl_info": [1, 3], "script": [1, 3, 9], "feed": 1, "binari": [1, 2, 3, 7, 11], "where": [1, 3, 5, 7], "scan": [1, 10], "output": [1, 2, 3, 9, 10], "all": [1, 2, 4, 5, 6, 8, 11], "purg": [1, 2, 3, 6, 9, 10], "vm_dir": [1, 3], "mem": [1, 2, 3], "work_dir": [1, 2, 3, 6, 7, 9], "exampl": [1, 2, 4, 5, 6, 10], "0xffffffffc0022000": 1, "0xffffffffc0042000": 1, "psmous": 1, "0xffffffffc0010000": 1, "0xffffffffc001a000": 1, "ahci": 1, "0xffffffffc0002000": 1, "0xffffffffc000a000": 1, "0xffffffff81000000": 1, "0xffffffff81a4aea0": 1, "core": 1, "pt": [1, 3, 4, 7, 8, 9, 10, 11], "filter": [1, 2, 7, 10], "seed": [1, 2, 3, 8, 9], "echo": [1, 2, 3, 11], "abcdefg1234567890": 1, "seed_dir": [1, 2, 3, 6, 10], "ip0": [1, 3, 6, 10], "view": [1, 9], "progress": [1, 8], "troubleshoot": 1, "sens": 1, "dir": [1, 8, 9], "continu": [1, 7, 11], "main": [1, 2, 4, 9, 11], "tbd": 1, "see": [1, 3, 5, 8, 9, 11], "readm": 1, "md": 1, "window": [1, 8], "option": [2, 3, 4, 5, 10], "replac": 2, "v0": [2, 5], "2": [2, 4, 8], "old": [2, 8], "singl": [2, 7], "kind": [2, 7], "fanci": 2, "packag": [2, 5, 6], "approach": [2, 7], "With": [2, 5], "shell": [2, 5, 11], "which": [2, 3, 4, 7, 8, 9, 10], "turn": 2, "load": [2, 10], "addit": [2, 5, 8, 9, 10], "via": [2, 5, 6, 8], "hypercal": [2, 4, 8], "transpar": 2, "todo": 2, "ar": [2, 3, 5, 6, 7, 8, 9, 10, 11], "integr": [2, 4, 9], "sourc": [2, 4, 5, 10], "separ": [2, 10], "from": [2, 3, 4, 5, 7, 9, 10, 11, 12], "packer": 2, "avoid": [2, 9], "frequent": [2, 8, 9], "modif": [2, 4, 11], "purpos": [2, 3], "second": [2, 8], "stage": [2, 8], "dub": 2, "below": 2, "actual": [2, 3, 7, 11], "non": [2, 6, 8, 9], "patch": [2, 4], "recent": [2, 11], "most": [2, 3, 10], "20": [2, 3, 8, 10, 11], "consid": 2, "same": [2, 5, 10], "problem": [2, 3], "activ": [2, 8, 10], "disabl": [2, 7, 10], "kaslr": 2, "pti": 2, "default": [2, 3, 5, 6, 9], "grub_cmdline_linux_default": 2, "grub_cmdline_linux": 2, "grub_timeout_styl": 2, "menu": 2, "grub_timeout": 2, "1": [2, 3, 4, 8], "grub_disable_recoveri": 2, "true": [2, 6], "mount": [2, 3], "bash": 2, "nbd": [2, 3], "nbd0": [2, 3], "nbd0p1": 2, "mnt": [2, 3], "hget": 2, "chmod": 2, "x": [2, 8], "reboot": [2, 5, 10, 11], "manual": [2, 3, 7], "snapshot": [2, 4, 7, 9, 10], "lock": [2, 7, 9], "still": [2, 9], "some": [2, 5, 9, 10, 11], "instead": [2, 3, 7, 10], "cron": 2, "sure": [2, 10, 11], "instal": [2, 3, 4, 5, 10, 12], "crontab": 2, "unount": 2, "disconnect": [2, 3], "import": [2, 9], "umount": [2, 3], "vulner": 2, "hprintf_test": 2, "review": 2, "understand": [2, 10, 12], "startup": [2, 7, 9, 10], "flow": 2, "secret": 2, "ingredi": 2, "issu": [2, 4, 7], "fetch": [2, 7], "store": [2, 7, 9], "runtim": [2, 4, 8], "select": [2, 5, 8], "ip": [2, 7], "reason": [2, 5], "decod": [2, 4, 7, 9, 10], "while": [2, 7], "possibl": [2, 3, 5, 10], "suppli": [2, 7, 9], "paramet": [2, 3, 5], "part": [2, 3, 7], "combin": [2, 7], "hinfo": 2, "hrang": 2, "accomplish": 2, "origin": 2, "simpli": [2, 7], "dump": [2, 7, 9, 10], "take": [2, 7], "list": [2, 3, 5, 6], "them": [2, 5, 9], "A": [2, 5, 8], "seen": [2, 8], "stdout": 2, "redirect": 2, "hcat": 2, "grep": [2, 11], "pipe": 2, "kafl_vuln": 2, "awk": 2, "print": [2, 7], "nr": 2, "xarg": 2, "usag": [2, 4, 8], "custom": [2, 4, 7], "python3": 2, "redqueen": [2, 4, 6, 8, 9, 10], "vm_imag": 2, "shm": [2, 6, 9, 10], "kafl_ubuntu": 2, "By": [2, 9], "now": [2, 3, 7, 11], "workdir": [2, 4, 8, 10], "qemu_serial_": 2, "ampl": 2, "frontend": [2, 4, 5, 7], "hprintf": [2, 7, 9, 10], "send": [2, 7], "printf": [2, 7], "string": [2, 5, 7], "python": [2, 4, 9, 11], "immedi": 2, "messag": [2, 11], "togeth": 2, "switch": [2, 3, 6], "more": [2, 4, 7, 9], "verbos": [2, 5, 6], "At": [2, 3, 12], "point": [2, 3, 6, 7, 9, 10, 11], "unpatch": 2, "special": [2, 3, 7, 9], "mode": 2, "exit": [2, 7, 9, 10], "error": [2, 3, 6, 7, 10], "intend": 2, "baselin": 2, "bootstrap": [2, 7, 10], "differ": [2, 3, 10], "scenario": [2, 4], "outsid": 2, "environ": [2, 4, 5, 9], "own": [2, 5], "extract": [2, 4], "function": [2, 7, 10], "hook": 2, "In": [2, 3, 5, 7, 10, 11], "particular": [2, 4, 10], "typic": [2, 4, 7, 9], "fail": [2, 3], "enough": 2, "just": [2, 3, 11], "complex": 2, "static": 2, "link": 2, "librari": [2, 3, 4], "encount": 2, "first": [2, 3, 7, 9, 10, 11], "next_payload": [2, 7], "mean": [2, 3, 7, 9], "okai": 2, "longer": 2, "phase": [2, 10], "befor": [2, 7, 11], "start": [2, 4, 7, 8, 11], "onli": [2, 3, 5, 7, 9], "after": [2, 3, 5], "resum": [2, 6, 7, 9, 10], "statu": [2, 8, 9], "its": 2, "wait": [2, 10], "state": [2, 9, 10], "due": [2, 9, 10], "bootup": 2, "ll": 3, "2019": 3, "evalu": [3, 9], "17763": 3, "737": 3, "190906": 3, "2324": 3, "rs5_release_svc_refresh_server_eval_x64fre_en": 3, "us_1": 3, "50g": 3, "everyth": [3, 6], "seem": [3, 10], "nat": 3, "network": 3, "give": 3, "access": 3, "well": [3, 4], "internet": 3, "move": [3, 11], "anywher": 3, "els": [3, 11], "correct": 3, "directori": [3, 5, 10, 11], "windows_x86_64": 3, "ex": [3, 6], "build": [3, 4, 5, 9, 11], "mingw": 3, "suggest": 3, "disk": [3, 9], "connect": 3, "sleep": 3, "nbd0p2": 3, "rmdir": 3, "without": [3, 10, 11], "should": [3, 6, 11, 12], "eventu": 3, "shut": 3, "down": [3, 8], "probabl": [3, 8], "freez": 3, "desktop": 3, "manag": [3, 5, 6, 9], "ctrl": 3, "alt": 3, "f3": 3, "killal": 3, "9": [3, 8, 10], "back": 3, "f1": 3, "check": [3, 4, 5, 11], "congratz": 3, "readi": [3, 9], "next": [3, 4, 7, 11], "payload": [3, 7, 8, 9, 10], "fed": 3, "map": 3, "pass": [3, 5], "0xfffff801ecf00000": 3, "0xfffff801ecf18000": 3, "lltdio": 3, "sy": 3, "0xfffff801ecf20000": 3, "0xfffff801ecf3b000": 3, "rspndr": 3, "0xfffff801ecf40000": 3, "0xfffff801ecf65000": 3, "bowser": 3, "0xfffff801ecf70000": 3, "0xfffff801ecf8a000": 3, "mpsdrv": 3, "find": [3, 8, 10, 12], "rememb": 3, "two": 3, "As": [3, 5], "consequ": 3, "occur": 3, "exist": [3, 6, 7, 9, 10], "ini": 3, "absolut": 3, "preffer": 3, "fatal": [3, 7], "pleas": [3, 4], "errno": 3, "104": 3, "reset": [3, 4], "peer": 3, "usual": 3, "mismatch": 3, "command": [3, 5, 6, 11], "again": 3, "argument": [3, 5, 6, 9], "ad": [3, 5, 7, 8], "afterward": 3, "cpu": [3, 8, 10, 11], "anoth": 3, "forgot": 3, "hang": [3, 7], "pci": [3, 10], "devic": [3, 5, 10], "0123456789abcdef": 3, "modifi": [3, 4], "src": 3, "vuln_test": 3, "chang": [3, 6, 11], "call": [3, 10], "properli": [3, 11], "0xfffff801ec850000": 3, "0xfffff801ec915000": 3, "add": 3, "too": 3, "kafl_gui": [3, 8, 9, 10], "observ": 3, "nyx": [4, 9, 10], "fast": [4, 10], "x86": [4, 10], "vm": [4, 7, 10, 11], "great": 4, "anyth": [4, 11], "firmwar": 4, "full": 4, "blown": 4, "oper": 4, "intel": [4, 5, 11], "vt": 4, "pml": 4, "achiev": [4, 5], "effici": 4, "greybox": 4, "whitebox": 4, "fuzz": [4, 7, 8, 11, 12], "allow": [4, 11], "mani": [4, 9], "fw": 4, "toolchain": [4, 11], "written": 4, "design": 4, "afl": 4, "extend": [4, 7], "mutat": [4, 8], "analysi": [4, 9], "radamsa": [4, 5, 6, 8, 9, 10], "grimoir": [4, 8, 10], "extens": 4, "introspect": 4, "input": [4, 6, 7, 8, 9, 10], "condit": 4, "instruct": 4, "overcom": 4, "magic": 4, "byte": [4, 8], "attempt": [4, 10], "identifi": 4, "keyword": [4, 5], "syntax": 4, "clever": 4, "larg": [4, 7], "scale": 4, "detail": [4, 8], "ijon": [4, 9], "visit": 4, "structur": 4, "around": [4, 5], "organis": 4, "subcompon": 4, "linux": [4, 5, 11, 12], "support": [4, 7, 9, 11], "libxdc": [4, 5, 7], "introduct": 4, "3": [4, 8], "4": [4, 8], "env": [4, 5, 9], "prefer": [4, 7], "known": [4, 7], "preced": 4, "kei": 4, "overrid": [4, 7, 9], "variabl": [4, 5, 9, 11], "dynaconf": 4, "cli": 4, "deploy": [4, 9, 11], "makefil": 4, "ansibl": [4, 11], "tag": [4, 9], "galaxi": 4, "compos": 4, "api": 4, "essenti": [4, 5, 11], "untest": 4, "fulli": 4, "convent": 4, "user": [4, 5, 6, 10, 11, 12], "interfac": [4, 7, 10, 12], "gui": 4, "built": [5, 10], "IT": 5, "autom": 5, "framework": [5, 6], "cloud": 5, "servic": 5, "provis": 5, "expect": [5, 9, 10], "inventori": 5, "remot": 5, "document": [5, 6, 10, 11, 12], "level": [5, 6, 7, 8, 10], "made": [5, 11], "playbook": 5, "compat": [5, 11], "necessari": [5, 11], "new": [5, 8, 11], "10": [5, 8, 10], "73": 5, "ensur": 5, "group": 5, "permiss": 5, "descript": 5, "accord": 5, "Will": 5, "localhost": 5, "enter": [5, 10, 11], "sub": [5, 11], "clean": 5, "remov": 5, "virtualenv": 5, "venv": 5, "forc": 5, "pull": 5, "everi": 5, "develop": [5, 9], "orient": 5, "rebuild": 5, "accept": 5, "line": [5, 6], "specifi": [5, 6], "end": [5, 12], "symbol": 5, "doubl": 5, "dash": 5, "These": 5, "underli": 5, "toggl": 5, "3rd": 5, "vvv": 5, "skip": [5, 11], "hardware_check": 5, "hardare_check": 5, "hack": 5, "quot": 5, "doesn": [5, 11], "extra": 5, "var": 5, "ansible_connect": 5, "fine": 5, "grain": 5, "control": [5, 7], "thei": [5, 9, 10], "featur": [5, 11], "describ": 5, "previous": [5, 7, 9, 10], "task": [5, 7, 8], "capston": 5, "hardwar": 5, "introduc": [5, 11, 12], "ci": 5, "kvm_devic": 5, "relat": [5, 9], "node": [5, 8], "reboot_kernel": 5, "respons": 5, "update_grub": 5, "entri": [5, 9], "One": [5, 7], "rewrit": [5, 7, 10], "scratch": 5, "better": [5, 9, 12], "fact": [5, 11], "ccc": 5, "harden": 5, "repo": 5, "And": 5, "commun": [5, 9], "cherri": 5, "pick": 5, "goal": 5, "mind": 5, "leverag": 5, "power": 5, "breakdown": 5, "modular": 5, "role": 5, "reusabl": 5, "regroup": 5, "each": [5, 8, 9, 10], "out": [5, 8, 10], "share": [5, 7, 9], "top": 5, "hand": 5, "subfold": 5, "yet": [5, 9], "publicli": 5, "websit": 5, "referenc": 5, "yml": 5, "name": [5, 7], "master": 5, "config": [6, 9, 10], "behind": 6, "scene": 6, "learn": [6, 8], "applic": 6, "yaml": [6, 10], "format": 6, "common": 6, "default_set": 6, "home": [6, 10], "pwd": 6, "kafl_config_fil": [6, 10], "kafl_test_featur": 6, "prefix": 6, "kafl_": 6, "kafl_process": 6, "8": [6, 8, 10], "valid": [6, 7, 10], "rais": [6, 7], "warn": [6, 10], "process": [6, 8, 9, 10, 11, 12], "quiet": 6, "dict": 6, "funki": [6, 8, 9], "afl_dump_mod": 6, "afl_skip_zero": 6, "afl_arith_max": 6, "redqueen_hash": 6, "redqueen_hamm": 6, "redqeen_simpl": 6, "cpu_offset": 6, "abort_tim": 6, "abort_exec": 6, "timeout_soft": 6, "timeout_check": 6, "kickstart": [6, 8, 10], "radamsa_path": 6, "qemu_imag": 6, "qemu_snapshot": 6, "qemu_bio": 6, "qemu_kernel": 6, "qemu_initrd": 6, "qemu_append": 6, "qemu_memori": 6, "qemu_bas": 6, "qemu_seri": 6, "qemu_extra": 6, "qemu_path": 6, "ip1": [6, 10], "ip2": 6, "ip3": 6, "sharedir": [6, 7, 10], "reload": [6, 7, 9], "snapshot_reload": 6, "gdbserver": 6, "log_hprintf": 6, "log_crash": 6, "timeout_hard": 6, "payload_s": 6, "bitmap_s": [6, 10], "trace_cb": 6, "iter": [6, 8], "action": 6, "ptdump_path": 6, "insensit": 6, "256": 6, "export": 6, "kafl_qemu_memori": 6, "kafl_log_hrpintf": 6, "come": 6, "interact": 6, "coordin": 7, "offer": [7, 10], "low": [7, 10], "inject": [7, 10], "acquir": 7, "collect": 7, "mark": 7, "stop": 7, "handshak": 7, "reach": 7, "return": [7, 8], "ok": 7, "backend": 7, "get_payload": 7, "get": [7, 10], "tell": 7, "write": [7, 9], "care": 7, "alloc": 7, "suffici": [7, 10], "buffer": 7, "page": [7, 9], "align": 7, "mmap": 7, "trigger": [7, 11], "regist": 7, "invoc": 7, "our": [7, 12], "alwai": 7, "anymor": 7, "pointer": 7, "veri": [7, 8], "forward": 7, "sanit": 7, "except": 7, "stack": 7, "kasan": [7, 8, 9], "crash": [7, 8, 9, 10], "event": 7, "submit_pan": 7, "submit_kasan": 7, "handler": 7, "overwrit": 7, "detect": [7, 10], "side": [7, 9], "unexpect": [7, 10], "inlin": 7, "macro": 7, "often": 7, "flexibl": 7, "place": [7, 10], "range_submit": 7, "easier": 7, "ipn": 7, "submit_cr3": 7, "cr3": 7, "valu": [7, 9], "limit": 7, "context": 7, "user_abort": 7, "signal": 7, "mainli": [7, 9, 10], "assert": [7, 10], "perspect": 7, "auto": [7, 10], "user_submit_mod": 7, "explicitli": 7, "32": [7, 8, 10], "bit": [7, 8, 10], "influenc": 7, "possibli": 7, "set_agent_config": 7, "capabl": 7, "get_host_config": 7, "queri": 7, "req_stream_data": 7, "data": 7, "correspondingli": 7, "folder": [7, 9], "dump_fil": 7, "null": 7, "mkstemp": 7, "templat": 7, "filenam": 7, "let": [7, 11], "uniqu": [7, 8], "user_fast_acquir": 7, "save": 7, "usermod": 7, "printk_addr": 7, "submit": 7, "printk": 7, "interpret": [7, 10, 11], "arg": 7, "panic_extend": [7, 8], "mix": [7, 9], "bug": [7, 12], "create_tmp_snapshot": 7, "increment": 7, "posit": 7, "debug_tmp_snapshot": 7, "nested_": 7, "roughli": 7, "equival": 7, "nest": 7, "l2": 7, "user_range_advis": 7, "get_argv": 7, "idea": 7, "get_program": 7, "deprec": 7, "render": 8, "variou": [8, 9, 10], "metadata": [8, 9], "curs": 8, "text": 8, "ui": 8, "quick": 8, "overview": 8, "campaign": [8, 9], "averag": 8, "grand": 8, "2h00m": 8, "exec": [8, 9, 10], "26": 8, "0m": 8, "stabil": 8, "worker": [8, 9, 10], "72": 8, "curexec": 8, "4018": 8, "est": 8, "74": 8, "avgexec": 8, "3616": 8, "timeout": [8, 9], "bitmap": [8, 9], "total": 8, "141": 8, "1h57m": 8, "45": 8, "edg": [8, 10], "11": [8, 10], "1k": 8, "addsan": 8, "fav": [8, 10], "18": [8, 10], "block": 8, "21": [8, 10], "2k": 8, "13m15": 8, "norm": 8, "123": 8, "col": 8, "3m27": 8, "yld": 8, "init": 8, "38": 8, "grim": 8, "redq": 8, "6": [8, 10, 11], "det": 8, "hvc": 8, "66": 8, "rq": 8, "gr": 8, "fin": 8, "12": [8, 10], "nrm": 8, "120": 8, "afl_splic": 8, "140": 8, "lvl": 8, "399": 8, "afl_havoc": 8, "97": 8, "395": [8, 10], "afl_flip_2": 8, "96": 8, "400": 8, "106": 8, "371": 8, "85": 8, "243": 8, "103": 8, "244": 8, "58": 8, "245": 8, "62": 8, "25": 8, "242": 8, "50": 8, "153": 8, "233": 8, "84": 8, "99": 8, "30": 8, "239": 8, "13": [8, 10], "241": 8, "14": [8, 10], "146": 8, "27": 8, "240": 8, "15": [8, 10], "afl_arith_2": 8, "id": [8, 10], "0kb": [8, 10], "perf": 8, "75m": 8, "score": 8, "0h02m": 8, "0x0000000": 8, "17": [8, 10], "9d": 8, "e4": 8, "47": 8, "90": 8, "f5": 8, "52": 8, "61": 8, "59": 8, "7c": 8, "dd": 8, "ac": 8, "8e": 8, "rai": 8, "0x0000010": 8, "8c": 8, "86": 8, "b0": 8, "92": 8, "77": 8, "fb": 8, "28": 8, "f0": 8, "4c": 8, "f7": 8, "23": 8, "49": 8, "75": 8, "94": 8, "w": [8, 10], "iu": 8, "0x0000020": 8, "d5": 8, "76": 8, "1b": 8, "5b": 8, "9e": 8, "e7": 8, "c6": 8, "91": 8, "51": 8, "6d": 8, "35": [8, 10], "40": 8, "qm5": 8, "0x0000030": 8, "80": 8, "8d": 8, "1a": 8, "fe": 8, "b4": 8, "22": [8, 10], "a0": 8, "a4": 8, "89": 8, "4f": 8, "0x0000040": 8, "ef": 8, "ea": 8, "6a": 8, "b2": 8, "7a": 8, "bc": 8, "fa": 8, "79": [8, 10], "f9": 8, "d1": 8, "da": 8, "j": [8, 10], "z": 8, "y": 8, "0x0000050": 8, "3b": 8, "63": 8, "93": 8, "1e": 8, "c7": 8, "41": 8, "xcy": 8, "0x0000060": 8, "cb": 8, "1f": 8, "df": 8, "3a": 8, "98": [8, 10], "31": 8, "37": 8, "34": 8, "q": [8, 11], "170141": 8, "0x0000070": 8, "33": 8, "36": [8, 10], "39": 8, "1834604692317316": 8, "0x0000080": 8, "83": 8, "60": 8, "c0": 8, "68": 8, "87303": 8, "h": 8, "0x0000090": 8, "f4": 8, "70": 8, "00": [8, 10], "71": 8, "46": 8, "fq": 8, "0x00000a0": 8, "f2": 8, "cf": 8, "1d": 8, "81": 8, "2c": 8, "f6": 8, "3e": 8, "5e": 8, "67": 8, "split": 8, "increasingli": 8, "indic": 8, "elaps": 8, "estim": 8, "rough": 8, "number": 8, "sum": 8, "per": 8, "overal": [8, 12], "fraction": 8, "watch": 8, "shallow": 8, "determinist": [8, 9], "vcpu": 8, "queue": 8, "favorit": 8, "normal": 8, "transit": 8, "discov": [8, 9], "basic": 8, "tracer": 8, "hash": [8, 9], "collis": 8, "intercept": 8, "yield": 8, "found": 8, "individu": 8, "havoc": 8, "respect": 8, "through": 8, "travers": 8, "lower": 8, "prioriti": 8, "compar": 8, "speed": 8, "assign": 8, "accumul": 9, "primari": 9, "locat": 9, "inspect": 9, "previou": 9, "session": 9, "post": 9, "triag": 9, "defin": [9, 10], "kafl_workdir": [9, 10], "rather": 9, "than": 9, "helper": 9, "unnecessari": 9, "prototyp": 9, "keep": 9, "entir": 9, "perman": 9, "popul": 9, "sever": [9, 10], "safeti": 9, "opposit": 9, "effect": 9, "delet": 9, "itself": 9, "corpus": [9, 10], "program": 9, "intern": 9, "ipc": 9, "sort": 9, "relev": 9, "mcat": 9, "msgpack": 9, "encod": 9, "tree": 9, "kafl_plot": 9, "gnuplot": 9, "stat": 9, "csv": 9, "over": 9, "tabl": 9, "worker_stats_n": 9, "hprintf_nn": 9, "serial_nn": 9, "excerpt": 9, "irregular": 9, "crash_xxxxxx": 9, "truncat": 9, "kasan_xxxxxx": 9, "timeo_xxxxxx": 9, "upload": 9, "hypercall_kafl_dump_fil": 9, "kafl_cov": [9, 10], "corpu": [9, 10], "payload_aaaaa": 9, "hypercall_kafl_pan": 9, "payload_bbbbb": 9, "hypercall_kafl_kasan": 9, "payload_ccccc": 9, "hypercall_kafl_releas": 9, "payload_ddddd": 9, "catch": 9, "meta": 9, "node_aaaaa": 9, "node_bbbbb": 9, "node_ccccc": 9, "node_ddddd": 9, "interest": [9, 10], "kafl_socket": 9, "socket": [9, 10], "between": 9, "interface_n": 9, "payload_n": 9, "aux_buffer_n": 9, "aux_buff": 9, "bitmap_n": 9, "ijon_n": 9, "radamsa_n": 9, "redqueen_workdir_n": 9, "page_cach": [9, 10], "addr": 9, "cach": 9, "global": 9, "main_crash_bitmap": 9, "main_kasan_bitmap": 9, "main_normal_bitmap": 9, "main_timeout_bitmap": 9, "fast_snapshot": 9, "mem_dump": 9, "mem_meta": 9, "qemu_st": 9, "fs_cach": 9, "txt": [9, 10], "show": 10, "how": [10, 12], "implement": 10, "userspac": [10, 11], "benefit": 10, "filesystem": 10, "silli": 10, "tdx": 10, "mmio": 10, "pio": 10, "read": 10, "virtio": 10, "branch": 10, "examples_root": 10, "depth": 10, "apt": 10, "gawk": 10, "bison": 10, "flex": 10, "openssl": 10, "libssl": 10, "libelf": 10, "lz4": 10, "dwarv": 10, "vanilla": 10, "kafl_config": 10, "bzimag": 10, "01": 10, "__": [10, 11], "___": [10, 11], "________": [10, 11], "_____": [10, 11], "_________": [10, 11], "____": [10, 11], "_": [10, 11], "No": 10, "region": 10, "pend": 10, "kafl64": 10, "v1": 10, "hypervisor": 10, "vmx": 10, "displai": [10, 11], "netdev": 10, "mynet0": 10, "chardev": 10, "nowait": 10, "nyx_socket": 10, "interface_0": 10, "worker_id": 10, "65536": 10, "input_buffer_s": 10, "131072": 10, "isa": 10, "kafl_seri": 10, "mux": 10, "serial_00": 10, "vda1": 10, "fast_vm_reload": 10, "invalid": 10, "02": 10, "got": 10, "5637": 10, "56msec": 10, "2kb": 10, "261": 10, "605": 10, "743": 10, "55msec": 10, "2298": 10, "2785": 10, "20msec": 10, "576": 10, "62msec": 10, "644": 10, "2072": 10, "99msec": 10, "03": 10, "52msec": 10, "19": 10, "49msec": 10, "25msec": 10, "42": 10, "3502": 10, "80msec": 10, "k": 10, "8667": 10, "15msec": 10, "calibr": 10, "1516": 10, "796": 10, "27msec": 10, "19msec": 10, "61msec": 10, "636": 10, "1132": 10, "54msec": 10, "trim": 10, "272": 10, "50msec": 10, "26msec": 10, "81msec": 10, "247": 10, "41msec": 10, "670": 10, "44msec": 10, "1kb": 10, "trim_cent": 10, "look": 10, "Be": 10, "hint": 10, "termin": 10, "what": 10, "imag": 10, "kafl_hprintf": 10, "try": 10, "hprintf_00": 10, "Then": 10, "replai": 10, "faithfulli": 10, "ptdump": 10, "big": 10, "ffffffff81000000": 10, "ffffffff83603000": 10, "ffffffff855ed000": 10, "ffffffff856e4000": 10, "abort": [10, 11], "finish": 10, "never": 10, "happen": 10, "consum": 10, "op": 10, "did": 10, "libxdc_decode_error": 10, "dynam": 10, "paravirtu": 10, "ftrace": 10, "jump": 10, "label": 10, "xyz": 10, "especi": 10, "emul": 10, "caus": [10, 12], "leak": 10, "dive": 11, "meet": 11, "processor": 11, "gen": 11, "skylak": 11, "although": 11, "broadwel": 11, "addion": 11, "intel_pt": 11, "proc": 11, "cpuinfo": 11, "fi": 11, "gcc": 11, "workflow": 11, "debian": 11, "bullsey": 11, "contain": 11, "might": 11, "glimps": 11, "touch": 11, "dry": 11, "prompt": 11, "press": 11, "onc": 11, "confort": 11, "becom": 11, "passwordless": 11, "nopasswd": 11, "sudoer": 11, "complet": 11, "newli": 11, "acsii": 11, "art": 11, "logo": 11, "regard": 11, "refer": [11, 12], "tutori": 12, "real": 12, "throughout": 12, "analyz": 12, "abl": 12, "few": 12, "adapt": 12}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"build": [0, 1, 10], "document": [0, 4], "get": [1, 3], "start": [1, 3, 10], "linux": [1, 2, 10], "fuzz": [1, 2, 3, 10], "prepar": [1, 2, 3], "vm": [1, 2, 3], "imag": [1, 2, 3], "option": [1, 7, 9], "1": [1, 10, 11], "full": 1, "instal": [1, 11], "manual": 1, "2": [1, 10, 11], "from": [1, 6], "filesystem": 1, "autom": 1, "snapshot": [1, 3], "us": 2, "nyx": [2, 7], "htool": 2, "sharedir": 2, "o": 2, "creat": 2, "deploi": [2, 11], "loader": 2, "script": 2, "launch": 2, "note": 2, "window": 3, "base": 3, "obtain": 3, "driver": 3, "virtual": 3, "address": 3, "rang": 3, "troubleshoot": 3, "kafl": [4, 5, 7, 8, 9, 11], "": 4, "featur": 4, "compon": 4, "content": [4, 9], "tutori": 4, "refer": 4, "develop": 4, "deploy": 5, "system": 5, "modif": 5, "makefil": 5, "target": [5, 10], "extra_arg": 5, "ansibl": 5, "tag": 5, "galaxi": 5, "compos": 5, "intellab": 5, "collect": 5, "reus": 5, "fuzzer": 6, "configur": [6, 9, 10], "sourc": [6, 11], "preced": 6, "kei": 6, "overrid": 6, "set": [6, 11], "environ": [6, 11], "variabl": 6, "dynaconf": 6, "cli": 6, "hypercal": 7, "api": 7, "essenti": 7, "further": 7, "untest": 7, "fulli": 7, "integr": 7, "user": 8, "interfac": 8, "gui": 8, "workdir": 9, "usag": 9, "convent": 9, "detail": 9, "kernel": 10, "download": 10, "patch": 10, "port": 10, "your": 10, "prefer": 10, "3": [10, 11], "4": [10, 11], "next": 10, "step": 10, "5": [10, 11], "known": 10, "issu": 10, "requir": 11, "hardwar": 11, "softwar": 11, "clone": 11, "make": 11, "env": 11, "verifi": 11, "introduct": 12}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 57}, "alltitles": {"Building the documentation": [[0, "building-the-documentation"]], "Getting Started with Linux Fuzzing": [[1, "getting-started-with-linux-fuzzing"]], "Preparing a Linux VM Image": [[1, "preparing-a-linux-vm-image"]], "Option #1: Full VM Install (Manual)": [[1, "option-1-full-vm-install-manual"]], "Option #2: Build from Filesystem (Automated)": [[1, "option-2-build-from-filesystem-automated"]], "Preparing the Fuzzing Snapshot": [[1, "preparing-the-fuzzing-snapshot"]], "Fuzzing": [[1, "fuzzing"], [3, "fuzzing"], [3, "id1"]], "Using Nyx htools + sharedir for OS Fuzzing": [[2, "using-nyx-htools-sharedir-for-os-fuzzing"]], "Create Linux VM Image": [[2, "create-linux-vm-image"]], "Deploy Loader Script": [[2, "deploy-loader-script"]], "Prepare sharedir and launch VM": [[2, "prepare-sharedir-and-launch-vm"]], "Notes": [[2, "notes"]], "Getting Started with Windows Fuzzing": [[3, "getting-started-with-windows-fuzzing"]], "Preparing Windows VM": [[3, "preparing-windows-vm"]], "Preparing base image": [[3, "preparing-base-image"]], "Preparing fuzzing snapshot": [[3, "preparing-fuzzing-snapshot"]], "Obtaining driver virtual address range": [[3, "obtaining-driver-virtual-address-range"]], "Troubleshooting": [[3, "troubleshooting"], [3, "id2"]], "\ud83d\udcd7 kAFL\u2019s Documentation": [[4, "kafl-s-documentation"]], "Features": [[4, "features"]], "Components": [[4, "components"]], "Contents": [[4, "contents"]], "Tutorials": [[4, null]], "Reference": [[4, null]], "Development": [[4, null]], "Deployment": [[5, "deployment"]], "System modifications": [[5, "system-modifications"]], "Makefile targets": [[5, "makefile-targets"]], "EXTRA_ARGS": [[5, null]], "Ansible tags": [[5, "ansible-tags"]], "Ansible Galaxy and composability": [[5, "ansible-galaxy-and-composability"]], "intellabs.kafl Ansible collection": [[5, "intellabs-kafl-ansible-collection"]], "Reusing the collection": [[5, "reusing-the-collection"]], "Fuzzer Configuration": [[6, "fuzzer-configuration"]], "Configuration sources and precedence": [[6, "configuration-sources-and-precedence"]], "Configuration keys": [[6, "configuration-keys"]], "Overriding settings from environment variables": [[6, "overriding-settings-from-environment-variables"]], "Dynaconf CLI": [[6, "dynaconf-cli"]], "kAFL/Nyx Hypercall API": [[7, "kafl-nyx-hypercall-api"]], "Essential hypercalls": [[7, "essential-hypercalls"]], "Further optional hypercalls": [[7, "further-optional-hypercalls"]], "Untested and not fully integrated": [[7, "untested-and-not-fully-integrated"]], "kAFL User Interface": [[8, "kafl-user-interface"]], "kAFL GUI": [[8, "kafl-gui"]], "kAFL Workdir": [[9, "kafl-workdir"]], "Usage Conventions": [[9, "usage-conventions"]], "Configuration Options": [[9, "configuration-options"]], "Detailed Content": [[9, "detailed-content"]], "Fuzzing the Linux Kernel": [[10, "fuzzing-the-linux-kernel"]], "1. Download patched Linux kernel (or port to your preferred kernel)": [[10, "download-patched-linux-kernel-or-port-to-your-preferred-kernel"]], "2. Configure and build target kernel": [[10, "configure-and-build-target-kernel"]], "3. Start fuzzing!": [[10, "start-fuzzing"]], "4. Next steps..": [[10, "next-steps"]], "5. Known Issues": [[10, "known-issues"]], "Installation": [[11, "installation"]], "1. Requirements": [[11, "requirements"]], "1.1 Hardware": [[11, "hardware"]], "1.2 Software": [[11, "software"]], "2. Cloning the sources": [[11, "cloning-the-sources"]], "3. Deploying kAFL : make deploy": [[11, "deploying-kafl-make-deploy"]], "4. Setting kAFL environment : make env": [[11, "setting-kafl-environment-make-env"]], "5. Verify the installation": [[11, "verify-the-installation"]], "Introduction": [[12, "introduction"]]}, "indexentries": {}})